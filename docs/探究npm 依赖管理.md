---
password: ""
icon: ""
åˆ›å»ºæ—¶é—´: "2023-04-07T19:15:00.000Z"
date: "2021-05-08"
type: Post
slug: zqsrm2
é…ç½®ç±»å‹:
  type: string
  string: æ–‡æ¡£
summary: æœ¬æ–‡ä¸»è¦ä»‹ç»äº† npm ä¾èµ–ç®¡ç†çš„æœºåˆ¶ï¼ŒåŒ…æ‹¬ npm å®‰è£…æœºåˆ¶ã€npm 2 å’Œ npm 3 æ¨¡å—å®‰è£…æœºåˆ¶çš„å·®å¼‚ã€npm 3 å¯¹äºåŒä¸€ä¾èµ–çš„ä¸åŒç‰ˆæœ¬çš„å¤„ç†ã€package-lock.json æ–‡ä»¶çš„ç»“æ„å’Œä½œç”¨ç­‰å†…å®¹ã€‚
æ›´æ–°æ—¶é—´: "2023-08-26T15:22:00.000Z"
title: æ¢ç©¶npm ä¾èµ–ç®¡ç†
category: æŠ€æœ¯åˆ†äº«
tags:
  - Npm
status: Archived
urlname: 701f9876-9f7a-4f28-b225-7077e45cfeab
updated: "2023-08-26 15:22:00"
---

# å‰è¨€

å…¶å®ä¹‹å‰å°±æœ‰ç–‘æƒ‘è¿‡,npm ä¾èµ–ä¹‹é—´æ˜¯æ€ä¹ˆå¤„ç†çš„,æ€ä¹ˆæ‰èƒ½ç›¸äº’ä¾èµ–è€Œåˆä¸é‡å¤ï¼Œæ€ä¹ˆå¤„ç†ä¸åŒç‰ˆæœ¬ä¾èµ–çš„é—®é¢˜ç­‰ç­‰ï¼Œä¹±æˆä¸€é”…ç²¥ã€‚å‡ºç°é”™è¯¯è¦æ€ä¹ˆè§£å†³? å“ªäº›è­¦å‘Šè¦é¢å¤–æ³¨æ„ä¸€ä¸‹?ä»Šå¤©å°±æ¥ç ”ç©¶ä¸‹ã€‚

# npm å®‰è£…æœºåˆ¶

## A å’Œ B åŒæ—¶ä¾èµ– Cï¼Œè¿™ä¸ªåŒ…ä¼šè¢«å®‰è£…åœ¨å“ªé‡Œå‘¢ï¼Ÿ

å‡å¦‚æœ‰ A å’Œ B ä¸¤ä¸ªåŒ…ï¼Œä¸¤ä¸ªåŒ…éƒ½ä¾èµ– C è¿™ä¸ªåŒ…ï¼Œnpm 2 ä¼šä¾æ¬¡é€’å½’å®‰è£… A å’Œ B ä¸¤ä¸ªåŒ…åŠå…¶å­ä¾èµ–åŒ…åˆ° node_modules ä¸­ã€‚æ‰§è¡Œå®Œæ¯•åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° `./node_modules` è¿™å±‚ç›®å½•åªå«æœ‰è¿™ä¸¤ä¸ªå­ç›®å½•ï¼š

```text
node_modules/
â”œâ”€â”¬ A
â”‚ â”œâ”€â”€ C
â”œâ”€â”¬ B
â”‚ â””â”€â”€ C
```

å¦‚æœä½¿ç”¨ npm 3 æ¥è¿›è¡Œå®‰è£…çš„è¯ï¼Œ`./node_modules` ä¸‹çš„ç›®å½•å°†ä¼šåŒ…å«ä¸‰ä¸ªå­ç›®å½•ï¼š

```text
node_modules/
â”œâ”€â”¬ A
â”œâ”€â”¬ B
â”œâ”€â”¬ C
```

ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„åŒºåˆ«å‘¢ï¼Ÿè¿™å°±è¦ä» npm çš„å·¥ä½œæ–¹å¼è¯´èµ·äº†ï¼š

## npm 2 å’Œ npm 3 æ¨¡å—å®‰è£…æœºåˆ¶çš„å·®å¼‚

è™½ç„¶ç›®å‰æœ€æ–°çš„ npm ç‰ˆæœ¬æ˜¯ npm 7ï¼Œä½† npm 2 åˆ° npm 3 çš„ç‰ˆæœ¬å˜æ›´ä¸­å®ç°äº†ç›®å½•æ‰“å¹³ï¼Œä¸å…¶ä»–ç‰ˆæœ¬ç›¸æ¯”å·®åˆ«è¾ƒå¤§ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬å…·ä½“çœ‹ä¸‹è¿™ä¸¤ä¸ªç‰ˆæœ¬çš„å·®å¼‚ã€‚

npm 2 åœ¨å®‰è£…ä¾èµ–åŒ…æ—¶ï¼Œé‡‡ç”¨ç®€å•çš„é€’å½’å®‰è£…æ–¹æ³•ã€‚æ‰§è¡Œ

```text
npm install
```

åï¼Œnpm æ ¹æ® dependencies å’Œ devDependencies å±æ€§ä¸­æŒ‡å®šçš„åŒ…æ¥ç¡®å®šç¬¬ä¸€å±‚ä¾èµ–ï¼Œnpm 2 ä¼šæ ¹æ®ç¬¬ä¸€å±‚ä¾èµ–çš„å­ä¾èµ–ï¼Œé€’å½’å®‰è£…å„ä¸ªåŒ…åˆ°å­ä¾èµ–çš„ node_modules ä¸­ï¼Œç›´åˆ°å­ä¾èµ–ä¸å†ä¾èµ–å…¶ä»–æ¨¡å—ã€‚æ‰§è¡Œå®Œæ¯•åï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°

```text
./node_modules
```

è¿™å±‚ç›®å½•ä¸­åŒ…å«æœ‰æˆ‘ä»¬ package.json æ–‡ä»¶ä¸­æ‰€æœ‰çš„ä¾èµ–åŒ…ï¼Œè€Œè¿™äº›ä¾èµ–åŒ…çš„å­ä¾èµ–åŒ…éƒ½å®‰è£…åœ¨äº†è‡ªå·±çš„ node_modules ä¸­ ï¼Œå½¢æˆç±»ä¼¼äºä¸‹é¢çš„ä¾èµ–æ ‘ï¼š

![](https://blogimagesrep-1257180516.cos.ap-guangzhou.myqcloud.com/1874-blog-images/3b78b4ff59692bac662a6839e35e3c7d.png)

è¿™æ ·çš„ç›®å½•æœ‰è¾ƒä¸ºæ˜æ˜¾çš„å¥½å¤„ï¼š 1ï¼‰å±‚çº§ç»“æ„éå¸¸æ˜æ˜¾ï¼Œå¯ä»¥æ¸…æ¥šçš„åœ¨ç¬¬ä¸€å±‚çš„ node_modules ä¸­çœ‹åˆ°æˆ‘ä»¬å®‰è£…çš„æ‰€æœ‰åŒ…çš„å­ç›®å½•ï¼› 2ï¼‰åœ¨å·²çŸ¥è‡ªå·±æ‰€éœ€åŒ…çš„åå­—ä»¥åŠç‰ˆæœ¬å·æ—¶ï¼Œå¯ä»¥å¤åˆ¶ç²˜è´´ç›¸åº”çš„æ–‡ä»¶åˆ° node_modules ä¸­ï¼Œç„¶åæ‰‹åŠ¨æ›´æ”¹ package.json ä¸­çš„é…ç½®ï¼› 3ï¼‰å¦‚æœæƒ³è¦åˆ é™¤æŸä¸ªåŒ…ï¼Œåªéœ€è¦ç®€å•çš„åˆ é™¤ package.json æ–‡ä»¶ä¸­ç›¸åº”çš„æŸä¸€è¡Œï¼Œç„¶ååˆ é™¤ node_modules ä¸­è¯¥åŒ…çš„ç›®å½•ï¼› ä½†æ˜¯è¿™æ ·çš„å±‚çº§ç»“æ„ä¹Ÿæœ‰è¾ƒä¸ºæ˜æ˜¾çš„ç¼ºé™·ï¼Œå½“æˆ‘çš„ Aï¼ŒBï¼ŒC ä¸‰ä¸ªåŒ…ä¸­æœ‰ç›¸åŒçš„ä¾èµ– D æ—¶ï¼Œæ‰§è¡Œ

```text
npm install
```

åï¼ŒD ä¼šè¢«é‡å¤ä¸‹è½½ä¸‰æ¬¡ï¼Œè€Œéšç€æˆ‘ä»¬çš„é¡¹ç›®è¶Šæ¥è¶Šå¤æ‚ï¼Œnode_modules ä¸­çš„ä¾èµ–æ ‘ä¹Ÿä¼šè¶Šæ¥è¶Šå¤æ‚ï¼Œåƒ D è¿™æ ·çš„åŒ…ä¹Ÿä¼šè¶Šæ¥è¶Šå¤šï¼Œé€ æˆäº†å¤§é‡çš„å†—ä½™ï¼›åœ¨ windows ç³»ç»Ÿä¸­ï¼Œç”šè‡³ä¼šå› ä¸ºç›®å½•çš„å±‚çº§å¤ªæ·±å¯¼è‡´æ–‡ä»¶çš„è·¯å¾„è¿‡é•¿ï¼Œè§¦å‘æ–‡ä»¶è·¯å¾„ä¸èƒ½è¶…è¿‡ 280 ä¸ªå­—ç¬¦çš„é”™è¯¯ï¼›

ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œnpm 3 çš„ node_modules ç›®å½•æ”¹æˆäº†æ›´ä¸ºæ‰å¹³çŠ¶çš„å±‚çº§ç»“æ„ï¼Œå°½é‡æŠŠä¾èµ–ä»¥åŠä¾èµ–çš„ä¾èµ–å¹³é“ºåœ¨ node_modules æ–‡ä»¶å¤¹ä¸‹å…±äº«ä½¿ç”¨ã€‚

## npm 3 å¯¹äºåŒä¸€ä¾èµ–çš„ä¸åŒç‰ˆæœ¬ä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ

npm 3 ä¼šéå†æ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œé€ä¸ªå°†æ¨¡å—æ”¾åœ¨ node_modules çš„ç¬¬ä¸€å±‚ï¼Œå½“å‘ç°æœ‰é‡å¤æ¨¡å—æ—¶ï¼Œåˆ™ä¸¢å¼ƒï¼Œ å¦‚æœé‡åˆ°æŸäº›ä¾èµ–ç‰ˆæœ¬ä¸å…¼å®¹çš„é—®é¢˜ï¼Œåˆ™ç»§ç»­é‡‡ç”¨ npm 2 çš„å¤„ç†æ–¹å¼ï¼Œå‰é¢çš„æ”¾åœ¨ node_modules ç›®å½•ä¸­ï¼Œåé¢çš„æ”¾åœ¨ä¾èµ–æ ‘ä¸­ã€‚ä¸¾ä¸ªä¾‹å­ï¼š Aï¼ŒBï¼Œä¾èµ– D(v 0.0.1)ï¼ŒC ä¾èµ– D(v 0.0.2):

![](https://blogimagesrep-1257180516.cos.ap-guangzhou.myqcloud.com/1874-blog-images/c04dae56ff53a7d5fd805368a03efd1f.png)

ä½†æ˜¯ npm 3 ä¼šå¸¦æ¥ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šç”±äºåœ¨æ‰§è¡Œ npm install çš„æ—¶å€™ï¼ŒæŒ‰ç…§ package.json é‡Œä¾èµ–çš„é¡ºåºä¾æ¬¡è§£æï¼Œä¸Šå›¾å¦‚æœ C çš„é¡ºåºåœ¨ Aï¼ŒB çš„å‰è¾¹ï¼Œnode_modules æ ‘åˆ™ä¼šæ”¹å˜ï¼Œä¼šå‡ºç°ä¸‹è¾¹çš„æƒ…å†µï¼š

![](https://blogimagesrep-1257180516.cos.ap-guangzhou.myqcloud.com/1874-blog-images/64cbbe7e1536fbe1ef29df46ca6d5cb3.png)

ç”±æ­¤å¯è§ï¼Œnpm 3 å¹¶æœªå®Œå…¨è§£å†³å†—ä½™çš„é—®é¢˜ï¼Œç”šè‡³è¿˜ä¼šå¸¦æ¥æ–°çš„é—®é¢˜ã€‚

# ä¸ºä»€ä¹ˆä¼šå‡ºç° package-lock.json å‘¢ï¼Ÿ

## package.json çš„ä¸è¶³ä¹‹å¤„

npm install æ‰§è¡Œåï¼Œä¼šç”Ÿæˆä¸€ä¸ª node_modules æ ‘ï¼Œåœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œ å¸Œæœ›å¯¹äºåŒä¸€ä¸ª package.json æ€»æ˜¯ç”Ÿæˆå®Œå…¨ç›¸åŒ node_modules æ ‘ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç¡®å®å¦‚æ­¤ã€‚ä½†åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œnpm æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚æœ‰ä»¥ä¸‹ä¸¤ä¸ªåŸå› ï¼š 1ï¼‰æŸäº›ä¾èµ–é¡¹è‡ªä¸Šæ¬¡å®‰è£…ä»¥æ¥ï¼Œå¯èƒ½å·²å‘å¸ƒäº†æ–°ç‰ˆæœ¬ ã€‚æ¯”å¦‚ï¼šA åŒ…åœ¨å›¢é˜Ÿä¸­ç¬¬ä¸€ä¸ªäººå®‰è£…çš„æ—¶å€™æ˜¯ 1.0.5 ç‰ˆæœ¬ï¼Œpackage.json ä¸­çš„é…ç½®é¡¹ä¸º `A: '^1.0.5'` ï¼›å›¢é˜Ÿä¸­ç¬¬äºŒä¸ªäººæŠŠä»£ç æ‹‰ä¸‹æ¥çš„æ—¶å€™ï¼ŒA åŒ…çš„ç‰ˆæœ¬å·²ç»å‡çº§æˆäº† 1.0.8ï¼Œæ ¹æ® package.json ä¸­çš„[semver-range version](http://semver.org/) è§„èŒƒï¼Œæ­¤æ—¶ç¬¬äºŒä¸ªäºº npm install å A çš„ç‰ˆæœ¬ä¸º 1.0.8ï¼› å¯èƒ½ä¼šé€ æˆå› ä¸ºä¾èµ–ç‰ˆæœ¬ä¸åŒè€Œå¯¼è‡´çš„ bugï¼› 2ï¼‰é’ˆå¯¹ 1ï¼‰ä¸­çš„é—®é¢˜ï¼Œå¯èƒ½æœ‰çš„å°ä¼™ä¼´ä¼šæƒ³ï¼ŒæŠŠ A çš„ç‰ˆæœ¬å·å›ºå®šä¸º `A: '1.0.5'` ä¸å°±å¯ä»¥äº†å—ï¼Ÿä½†æ˜¯è¿™æ ·çš„åšæ³•å…¶å®å¹¶æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œ æ¯”å¦‚ A çš„æŸä¸ªä¾èµ–åœ¨ç¬¬ä¸€ä¸ªäººä¸‹è½½çš„æ—¶å€™æ˜¯ 2.1.3 ç‰ˆæœ¬ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªäººä¸‹è½½çš„æ—¶å€™å·²ç»å‡çº§åˆ°äº† 2.2.5 ç‰ˆæœ¬ï¼Œæ­¤æ—¶ç”Ÿæˆçš„ node_modules æ ‘ä¾æ—§ä¸å®Œå…¨ç›¸åŒ ï¼Œå›ºå®šç‰ˆæœ¬åªæ˜¯å›ºå®šæ¥è‡ªèº«çš„ç‰ˆæœ¬ï¼Œä¾èµ–çš„ç‰ˆæœ¬æ— æ³•å›ºå®šã€‚

## é’ˆå¯¹ package.json ä¸è¶³çš„è§£å†³æ–¹æ³•

ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ä»¥åŠ npm 3 çš„é—®é¢˜ï¼Œåœ¨ npm 5.0 ç‰ˆæœ¬åï¼Œnpm install åéƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª package-lock.json æ–‡ä»¶ ï¼Œå½“åŒ…ä¸­æœ‰ package-lock.json æ–‡ä»¶æ—¶ï¼Œnpm install æ‰§è¡Œæ—¶ï¼Œå¦‚æœ package.json å’Œ package-lock.json ä¸­çš„ç‰ˆæœ¬å…¼å®¹ï¼Œä¼šæ ¹æ® package-lock.json ä¸­çš„ç‰ˆæœ¬ä¸‹è½½ï¼›å¦‚æœä¸å…¼å®¹ï¼Œå°†ä¼šæ ¹æ® package.json çš„ç‰ˆæœ¬ï¼Œæ›´æ–° package-lock.json ä¸­çš„ç‰ˆæœ¬ï¼Œå·²ä¿è¯ package-lock.json ä¸­çš„ç‰ˆæœ¬å…¼å®¹ package.jsonã€‚

## package-lock.json æ–‡ä»¶çš„ç»“æ„

package-lock.json æ–‡ä»¶ä¸­çš„ nameã€version ä¸ package.json ä¸­çš„ nameã€version ä¸€æ ·ï¼Œæè¿°äº†å½“å‰åŒ…çš„åå­—å’Œç‰ˆæœ¬ï¼Œdependencies æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å’Œ node_modules ä¸­çš„åŒ…ç»“æ„ä¸€ä¸€å¯¹åº”ï¼Œå¯¹è±¡çš„ key ä¸ºåŒ…çš„åç§°ï¼Œå€¼ä¸ºåŒ…çš„ä¸€äº›æè¿°ä¿¡æ¯ï¼Œ æ ¹æ® [package-lock-json å®˜æ–¹æ–‡æ¡£](https://docs.npmjs.com/configuring-npm/package-lock-json.html#requires)ï¼Œä¸»è¦çš„ç»“æ„å¦‚ä¸‹ï¼š

- `version` ï¼šåŒ…ç‰ˆæœ¬ï¼Œå³è¿™ä¸ªåŒ…å½“å‰å®‰è£…åœ¨ `node_modules` ä¸­çš„ç‰ˆæœ¬
- `resolved` ï¼šåŒ…å…·ä½“çš„å®‰è£…æ¥æº
- `integrity` ï¼šåŒ… `hash` å€¼ï¼ŒéªŒè¯å·²å®‰è£…çš„è½¯ä»¶åŒ…æ˜¯å¦è¢«æ”¹åŠ¨è¿‡ã€æ˜¯å¦å·²å¤±æ•ˆ
- `requires` ï¼šå¯¹åº”å­ä¾èµ–çš„ä¾èµ–ï¼Œä¸å­ä¾èµ–çš„ `package.json` ä¸­ `dependencies` çš„ä¾èµ–é¡¹ç›¸åŒ
- `dependencies` ï¼šç»“æ„å’Œå¤–å±‚çš„ `dependencies` ç»“æ„ç›¸åŒï¼Œå­˜å‚¨å®‰è£…åœ¨å­ä¾èµ– `node_modules` ä¸­çš„ä¾èµ–åŒ…

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å­ä¾èµ–éƒ½æœ‰ `dependencies` å±æ€§ã€‚åªæœ‰å½“å­ä¾èµ–çš„ä¾èµ–å’Œå½“å‰å·²å®‰è£…åœ¨æ ¹ç›®å½•çš„ `node_modules` ä¸­çš„ä¾èµ–å†²çªä¹‹åï¼Œæ‰ä¼šæœ‰è¿™ä¸ªå±æ€§ã€‚

![](https://blogimagesrep-1257180516.cos.ap-guangzhou.myqcloud.com/1874-blog-images/bb444073bebe7fffaee5215174aa1966.png)

## package-lock.json æ–‡ä»¶çš„ä½œç”¨

- åœ¨å›¢é˜Ÿå¼€å‘ä¸­ï¼Œç¡®ä¿æ¯ä¸ªå›¢é˜Ÿæˆå‘˜å®‰è£…çš„ä¾èµ–ç‰ˆæœ¬æ˜¯ä¸€è‡´çš„ï¼Œç¡®å®šä¸€æ£µå”¯ä¸€çš„ node_modules æ ‘ï¼›
- node_modules ç›®å½•æœ¬èº«æ˜¯ä¸ä¼šè¢«æäº¤åˆ°ä»£ç åº“çš„ï¼Œä½†æ˜¯ package-lock.json å¯ä»¥æäº¤åˆ°ä»£ç åº“ï¼Œå¦‚æœå¼€å‘äººå‘˜æƒ³è¦å›æº¯åˆ°æŸä¸€å¤©çš„ç›®å½•çŠ¶æ€ï¼Œåªéœ€è¦æŠŠ package.json å’Œ package-lock.json è¿™ä¸¤ä¸ªæ–‡ä»¶å›é€€åˆ°é‚£ä¸€å¤©å³å¯ ã€‚
- ç”±äº package-lock.json å’Œ node_modules ä¸­çš„ä¾èµ–åµŒå¥—å®Œå…¨ä¸€è‡´ï¼Œå¯ä»¥æ›´åŠ æ¸…æ¥šçš„äº†è§£æ ‘çš„ç»“æ„åŠå…¶å˜åŒ–ã€‚
- åœ¨å®‰è£…æ—¶ï¼Œnpm ä¼šæ¯”è¾ƒ node_modules å·²æœ‰çš„åŒ…ï¼Œå’Œ package-lock.json è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœé‡å¤çš„è¯ï¼Œå°±è·³è¿‡å®‰è£… ï¼Œä»è€Œä¼˜åŒ–äº†å®‰è£…çš„è¿‡ç¨‹ã€‚

# ä¾èµ–çš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯

npm ç›®å‰æ”¯æŒä»¥ä¸‹å‡ ç±»ä¾èµ–åŒ…ç®¡ç†åŒ…æ‹¬

- dependencies
- devDependencies å¼€å‘ç¯å¢ƒä¾èµ–åŒ…
- optionalDependencies å¯é€‰æ‹©çš„ä¾èµ–åŒ…
- peerDependencies åŒç­‰ä¾èµ–
- bundledDependencies æ†ç»‘ä¾èµ–åŒ…

### dependencies

æ— è®ºåœ¨å¼€å‘ç¯å¢ƒè¿˜æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒéƒ½å¿…é¡»ä½¿ç”¨çš„ä¾èµ–ï¼Œæ˜¯æœ€å¸¸ç”¨çš„ä¾èµ–åŒ…ç®¡ç†å¯¹è±¡ï¼Œä¾‹å¦‚ Reactï¼Œtypescriptï¼ŒAxios ç­‰ï¼Œé€šè¿‡ `npm install XXX` ä¸‹è½½çš„åŒ…éƒ½ä¼šé»˜è®¤å®‰è£…åœ¨ dependencies å¯¹è±¡ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ `npm install XXX -S` ä¸‹è½½ dependencies ä¸­çš„åŒ…ï¼› æ’ä»¶ä¸‹ dependencies ä¸­çš„ä¾èµ–ä¼šåœ¨å®‰è£…æ’ä»¶æ—¶å…¨éƒ¨å®‰è£…

### devDependencies

æŒ‡å¯ä»¥åœ¨å¼€å‘ç¯å¢ƒä½¿ç”¨çš„ä¾èµ–ï¼Œä¾‹å¦‚ eslintï¼Œ@types ç±»å‹å®šä¹‰æ–‡ä»¶ç­‰ï¼Œé€šè¿‡ `npm install XXX -D` ä¸‹è½½çš„åŒ…éƒ½ä¼šåœ¨ devDependencies å¯¹è±¡ä¸­ï¼› dependencies å’Œ devDependencies æœ€å¤§çš„åŒºåˆ«æ˜¯åœ¨æ‰“åŒ…è¿è¡Œæ—¶ï¼Œæ‰§è¡Œ Â `npm install`Â  æ—¶é»˜è®¤ä¼šæŠŠæ‰€æœ‰ä¾èµ–å…¨éƒ¨å®‰è£…ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨ Â `npm install --production`Â  æ—¶å°±åªä¼šå®‰è£… dependencies ä¸­çš„ä¾èµ–ï¼Œå¦‚æœæ˜¯ node æœåŠ¡é¡¹ç›®ï¼Œå°±å¯ä»¥é‡‡ç”¨è¿™æ ·çš„æ–¹å¼ç”¨äºæœåŠ¡è¿è¡Œæ—¶å®‰è£…å’Œæ‰“åŒ…ï¼Œå‡å°‘åŒ…å¤§å°ã€‚

### optionalDependencies

æŒ‡çš„æ˜¯å¯ä»¥é€‰æ‹©çš„ä¾èµ–ï¼Œå½“ä½ å¸Œæœ›æŸäº›ä¾èµ–å³ä½¿ä¸‹è½½å¤±è´¥æˆ–è€…æ²¡æœ‰æ‰¾åˆ°æ—¶ï¼Œé¡¹ç›®ä¾ç„¶å¯ä»¥æ­£å¸¸è¿è¡Œæˆ–è€… npm ç»§ç»­è¿è¡Œçš„æ—¶ï¼Œå°±å¯ä»¥æŠŠè¿™äº›ä¾èµ–æ”¾åœ¨ optionalDependencies å¯¹è±¡ä¸­. ä½†æ˜¯ optionalDependencies ä¼šè¦†ç›– dependencies ä¸­çš„åŒåä¾èµ–åŒ…ï¼Œæ‰€ä»¥ä¸è¦æŠŠä¸€ä¸ªåŒ…åŒæ—¶å†™è¿›ä¸¤ä¸ªå¯¹è±¡ä¸­ã€‚

optionalDependencies å°±åƒæ˜¯æˆ‘ä»¬çš„ä»£ç çš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ä¸€æ ·ï¼Œå¦‚æœåŒ…å­˜åœ¨çš„è¯å°±èµ°å­˜åœ¨çš„é€»è¾‘ï¼Œä¸å­˜åœ¨çš„å°±èµ°ä¸å­˜åœ¨çš„é€»è¾‘ã€‚ eg: å›¾ç‰‡å‹ç¼©æ’ä»¶åœ¨ windows å’Œ mac ä¸Šçš„é—®é¢˜

### peerDependencies

ç”¨äºæŒ‡å®šä½ å½“å‰çš„æ’ä»¶å…¼å®¹çš„å®¿ä¸»å¿…é¡»è¦å®‰è£…çš„åŒ…çš„ç‰ˆæœ¬ï¼Œè¿™ä¸ªæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ ğŸŒ°ï¼šæˆ‘ä»¬å¸¸ç”¨çš„ react ç»„ä»¶åº“ [ant-design@4.x](https://ant.design/index-cn) çš„ package.json ä¸­çš„é…ç½®å¦‚ä¸‹ï¼š

```json
{
  "peerDependencies": {
    "react": ">=16.9.0",
    "react-dom": ">=16.9.0"
  }
}
```

å‡è®¾æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º project çš„é¡¹ç›®ï¼Œåœ¨æ­¤é¡¹ç›®ä¸­æˆ‘ä»¬è¦ä½¿ç”¨ [ant-design@4.x](https://ant.design/index-cn) è¿™ä¸ª UI åº“ï¼Œæ­¤æ—¶æˆ‘ä»¬çš„é¡¹ç›®å°±å¿…é¡»å…ˆå®‰è£… React >= 16.9.0 å’Œ React-dom >= 16.9.0 çš„ç‰ˆæœ¬ã€‚

> æ³¨æ„: åœ¨ npm 2 ä¸­ï¼Œå½“æˆ‘ä»¬ä¸‹è½½

    [ant-design@4.x](https://ant.design/index-cn)


    [ant-design@4.x](https://ant.design/index-cn)


    ![](https://blogimagesrep-1257180516.cos.ap-guangzhou.myqcloud.com/1874-blog-images/2c31347250617a6ffd18e433c56fee89.png)

### é€‚ç”¨åœºæ™¯

é€šå¸¸æ˜¯åœ¨æ’ä»¶å¼€å‘çš„åœºæ™¯ä¸‹ï¼Œä½ çš„æ’ä»¶éœ€è¦æŸäº›ä¾èµ–çš„æ”¯æŒï¼Œä½†æ˜¯ä½ åˆæ²¡å¿…è¦å»å®‰è£…ï¼Œå› ä¸ºæ’ä»¶çš„å®¿ä¸»ä¼šå»å®‰è£…è¿™äº›ä¾èµ–ï¼Œä½ å°±å¯ä»¥ç”¨ peerDependencies å»å£°æ˜ä¸€ä¸‹éœ€è¦ä¾èµ–çš„æ’ä»¶å’Œç‰ˆæœ¬ï¼Œå¦‚æœå‡ºé—®é¢˜ npm å°±ä¼šæœ‰è­¦å‘Šæ¥æé†’ä½¿ç”¨è€…å»è§£å†³ç‰ˆæœ¬å†²çªé—®é¢˜ã€‚

### bundledDependencies

æ†ç»‘ä¾èµ–ã€‚è¿™ä¸ªä¾èµ–é¡¹ä¸å…¶ä»–å‡ ç§ä¾èµ–é¡¹ä¸åŒï¼Œä»–ä¸æ˜¯ä¸€ä¸ªé”®å€¼å¯¹çš„å¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„é‡Œæ˜¯åŒ…åçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼š

```json
{
  "name": "project",
  "version": "1.0.0",
  "bundleDependencies": ["axios", "lodash"]
}
```

å½“ä½¿ç”¨ npm install æ—¶,è¿™ä¸¤ä¸ªä¾èµ–å’Œæ‰€éœ€è¦çš„ä¾èµ–éƒ½ä¼šå®‰è£…. å½“ä½¿ç”¨ npm pack çš„æ–¹å¼æ¥æ‰“åŒ…æ—¶ï¼Œä¸Šè¿°çš„ä¾‹å­ä¼šç”Ÿæˆä¸€ä¸ª project-1.0.0.tgz çš„æ–‡ä»¶ï¼Œåœ¨ä½¿ç”¨äº† bundledDependencies åï¼Œæ‰“åŒ…æ—¶ä¼šæŠŠ Axios å’Œ Lodash è¿™ä¸¤ä¸ªä¾èµ–ä¸€èµ·æ”¾å…¥åŒ…ä¸­ï¼Œä¹‹åæœ‰äººä½¿ç”¨ `npm install project-1.0.0.tgz` ä¸‹è½½åŒ…æ—¶ï¼ŒAxios å’Œ Lodash è¿™ä¸¤ä¸ªä¾èµ–ä¹Ÿä¼šè¢«å®‰è£…ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯å®‰è£…ä¹‹å Axios å’Œ Lodash è¿™ä¸¤ä¸ªåŒ…çš„ä¿¡æ¯åœ¨ dependencies ä¸­ï¼Œå¹¶ä¸”ä¸åŒ…æ‹¬ç‰ˆæœ¬ä¿¡æ¯ã€‚

```text
"bundleDependencies": [
    "axios",
    "lodash"
  ],
"dependencies": {
  "axios": "*",
  "lodash": "*"
}

```

### é€‚ç”¨åœºæ™¯

ä¾èµ–åŒ…é€šå¸¸æ˜¯ä» npm ä»“åº“ä¸­å®‰è£…çš„ã€‚è€Œ bundledDependencies è¿™æ˜¯ç”¨åœ¨ä»¥ä¸‹å‡ ä¸ªåœºæ™¯:

- å¤ç”¨ä¸æ˜¯æ¥è‡ª npm ä»“åº“æˆ–å·²ä¿®æ”¹çš„ç¬¬ä¸‰æ–¹åº“
- å°†è‡ªå·±çš„é¡¹ç›®ä½œä¸ºæ¨¡å—å¤ç”¨
- ä¸æ¨¡å—ä¸€èµ·å‘å¸ƒä¸€äº›æ–‡ä»¶

è¿™æ ·å°±ä¸å¿…åˆ›å»ºå’Œç»´æŠ¤è‡ªå·±çš„ npm æ’ä»¶ï¼Œä½†å¯ä»¥è·å¾—ä¸ npm åŒ…ç›¸åŒçš„ç»“æœã€‚

### ä¸é€‚ç”¨åœºæ™¯

å¦‚æœæ˜¯å¤„ç†è½¯ä»¶ç‰ˆæœ¬é”å®šé—®é¢˜, package-lock.json æ˜¯æ›´å¥½çš„é€‰æ‹©.

# å®é™…åº”ç”¨

## é—®é¢˜å‡ºç°

æœ€è¿‘æœ‰ä¸ªé¡¹ç›®åœ¨åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼ŒåŠ å…¥äº†å…¬å¸ç»Ÿä¸€çš„ Eslint ç®¡ç†ï¼Œéœ€è¦ç”¨åˆ°ä¸¤ä¸ªä¾èµ–åŒ…ã€‚

```text
"devDependencies": {
  "@yunke/eslint-config-react-ts": "^1.0.0",
  "@yunke/yunke-setting-plugin": "^1.1.0"
}
```

ä½†æ˜¯åœ¨ Windows ç”µè„‘ä¸Šï¼Œä¼šæŠ¥ `import/order` çš„ Eslint é¡ºåºé”™è¯¯ã€‚åœ¨ Mac ç”µè„‘ä¸Šåˆ™æ²¡æœ‰å‡ºç°è¿™ç§æƒ…å†µã€‚åœ¨ç ”ç©¶ä¾èµ–åŒ…çš„æ—¶å€™å‘ç°ï¼Œ`eslint-plugin-import` çš„ç‰ˆæœ¬å‡ºäº†ç‚¹é—®é¢˜ã€‚åœ¨ `@yunke/eslint-config-react-ts` çš„é…ç½®ä¸­ï¼Œéœ€è¦çš„ç‰ˆæœ¬æ˜¯ `>=2.22.1`ã€‚è€Œå®é™…åœ¨é¡¹ç›®ä¸­è¢«å®‰è£…çš„ç‰ˆæœ¬ç¡®æ˜¯ `2.20.1`ã€‚å¯¼è‡´ç‰ˆæœ¬å®‰è£…ä¸å¯¹çš„åŸå› åˆ™æ˜¯å› ä¸ºé¡¹ç›®ä¸­ä½¿ç”¨çš„ `react-scripts` æ’ä»¶æŒ‡å®šéœ€è¦ `2.20.1` çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ç–‘æƒ‘ç‚¹æ¥äº†ï¼Œä¸ºä»€ä¹ˆä¸¤ä¸ªæ’ä»¶éœ€è¦çš„æ’ä»¶ç‰ˆæœ¬ä¸ä¸€æ ·å´åªå®‰è£…ä¸€ä¸ªå‘¢ã€‚

![](https://blogimagesrep-1257180516.cos.ap-guangzhou.myqcloud.com/1874-blog-images/3ff0621c87c0f2e7726f7cc0ebb183bb.png)

![](https://blogimagesrep-1257180516.cos.ap-guangzhou.myqcloud.com/1874-blog-images/539435e872da29ba6e6431e6d9d2235d.png)

## æ¢ç©¶

éšåä»”ç»†ç ”ç©¶äº†`@yunke/eslint-config-react-ts`å’Œ`react-scripts`çš„`package.json`ï¼Œå‘ç°ä¸€ä¸ªé‡è¦çš„é—®é¢˜ï¼Œä¹Ÿæ˜¯ä¸Šé¢æåˆ°è¿‡çš„ï¼Œ`@yunke/eslint-config-react-ts`æ‰€ä¾èµ–çš„`eslint-plugin-import`æ’ä»¶æ˜¯æ”¾åœ¨ peerDependencies ä¸­å®šä¹‰çš„ï¼Œè€Œåœ¨ npm3 ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œä¸ä¼šè‡ªåŠ¨ä¸‹è½½è¿™é‡Œé¢çš„ä¾èµ–ï¼Œè€Œæ˜¯ä¼šä»¥ warning çš„æ–¹å¼æç¤ºå‡ºæ¥ï¼Œéœ€è¦å®¿ä¸»æ’ä»¶æ‰‹åŠ¨åœ¨`package.json`ä¸­å®šä¹‰å¹¶å®‰è£…ï¼Œè€Œ`react-scripts`æ‰€ä¾èµ–çš„`eslint-plugin-import`æ’ä»¶æ˜¯æ”¾åœ¨ dependencies ä¸­çš„ï¼Œæ‰€ä»¥ä¼šè¢«ä¸‹è½½ä¸‹æ¥ï¼Œä¸éœ€è¦å®šä¹‰ã€‚

### @yunke/eslint-config-react-ts çš„ä¾èµ–

![](https://blogimagesrep-1257180516.cos.ap-guangzhou.myqcloud.com/1874-blog-images/98eaae55c046445bbf63dc0c9291355d.png)

### react-scripts çš„ä¾èµ–

![](https://blogimagesrep-1257180516.cos.ap-guangzhou.myqcloud.com/1874-blog-images/76f1f7c55ce915ad45e774fabc406077.png)

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œnpm åœ¨åˆ†æä¾èµ–çš„æ—¶å€™ï¼Œä¼šæŠŠä¾èµ–æ‹å¹³ï¼Œä½†æ˜¯åƒè¿™åŒä¸€ä¾èµ–çš„ä¸åŒç‰ˆæœ¬çš„å¤„ç†ä¼šåƒä¸Šé¢åˆ†æçš„ä¸€æ ·ï¼Œreact-scripts ä¼šè®²è‡ªå·±æ‰€ä¾èµ–çš„ç‰ˆæœ¬æ”¾åœ¨è‡ªå·±çš„ node_modules ä¸­ï¼Œè€Œ@yunke/eslint-config-react-ts è¯´è¦æ±‚çš„åœ¨å®¿ä¸»ä¸Šå®‰è£…è¿™ä¸ªä¾èµ–åï¼Œåˆ™ä¼šç›´æ¥æ”¾åˆ°å®¿ä¸»çš„ node_modules ä¸­å»ã€‚

![](https://blogimagesrep-1257180516.cos.ap-guangzhou.myqcloud.com/1874-blog-images/c04dae56ff53a7d5fd805368a03efd1f.png)

![](https://blogimagesrep-1257180516.cos.ap-guangzhou.myqcloud.com/1874-blog-images/44742398f7b8628a4fad1526e4125502.png)

## è§£å†³åŠæ³•

åœ¨å®¿ä¸»æ’ä»¶ï¼Œä¹Ÿå°±æ˜¯é¡¹ç›®ä¸­çš„`package.json`ä¸­é‡æ–°å¼•å…¥`eslint-plugin-import`æ’ä»¶å¹¶å®šä¹‰ç‰ˆæœ¬å·ä¸º`>=2.22.1`å³å¯ï¼Œé‡æ–°`yarn install`åå°±ä¼šå®‰è£…ç¬¦åˆ`@yunke/eslint-config-react-ts`æ‰€éœ€è¦çš„ç‰ˆæœ¬ï¼Œè‡³æ­¤é”™è¯¯æ¶ˆå¤±ã€‚

## æ–°çš„ç–‘é—®

å…¶å®åœ¨`yarn install`æ—¶ï¼Œä¸å•å•æ˜¯æç¤º`eslint-plugin-import`çš„ç‰ˆæœ¬ä¸å¯¹ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ’ä»¶çš„ç‰ˆæœ¬ä¹Ÿä¸ç¬¦åˆè¦æ±‚ï¼Œä¾‹å¦‚ typescript çš„ç‰ˆæœ¬è¿‡ä½ç­‰é—®é¢˜ã€‚è¿™é‡Œå°±å¼•ç”³å‡ºä¸€ä¸ªé—®é¢˜ï¼Œåˆ°åº•å“ªäº›ä¾èµ–éœ€è¦æ”¾åˆ° peerDependencies ä¸­ï¼Œå“ªäº›ä¾èµ–éœ€è¦æ”¾åˆ° dependencies ä¸­ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªå€¼å¾—æ€è€ƒçš„é—®é¢˜ã€‚

![](https://blogimagesrep-1257180516.cos.ap-guangzhou.myqcloud.com/1874-blog-images/2c31347250617a6ffd18e433c56fee89.png)
